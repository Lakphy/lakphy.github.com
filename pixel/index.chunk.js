"use strict";(self.webpackChunk_rax_materials_scaffolds_app_ts=self.webpackChunk_rax_materials_scaffolds_app_ts||[]).push([[343],{573:function(e,t,n){n.r(t),n.d(t,{default:function(){return x}});var a,r=n(461),i=n(997);!function(e){e[e.WHITE=0]="WHITE",e[e.RED=1]="RED",e[e.RED_ORANGE=2]="RED_ORANGE",e[e.ORANGE=3]="ORANGE",e[e.ORANGE_YELLOW=4]="ORANGE_YELLOW",e[e.YELLOW=5]="YELLOW",e[e.YELLOW_GREEN=6]="YELLOW_GREEN",e[e.GREEN=7]="GREEN",e[e.GREEN_BLUE=8]="GREEN_BLUE",e[e.BLUE=9]="BLUE",e[e.BLUE_PURPLE=10]="BLUE_PURPLE",e[e.PURPLE=11]="PURPLE",e[e.PINK=12]="PINK",e[e.BLACK=13]="BLACK"}(a||(a={}));var o=["#ffffff","#ff4c4f","#ff7a45","#ffa940","#ffc53d","#ffec3d","#bae637","#7Ad03f","#38cec9","#40a8ff","#5a7ef8","#9253df","#f75aab","#000000"],c={currentColor:a.BLACK,matrix:1,drawingMap:[],editable:!0,received:!1},l=n(346),s=n(487),u=(n(527),(0,l.l9)({useEffect:r.useEffect})),d=(u.usePageShow,u.usePageHide,[["000000","0"],["000001","1"],["000010","2"],["000011","3"],["000100","4"],["000101","5"],["000110","6"],["000111","7"],["001000","8"],["001001","9"],["001010","a"],["001011","b"],["001100","c"],["001101","d"],["001110","e"],["001111","f"],["010000","g"],["010001","h"],["010010","i"],["010011","j"],["010100","k"],["010101","l"],["010110","m"],["010111","n"],["011000","o"],["011001","p"],["011010","q"],["011011","r"],["011100","s"],["011101","t"],["011110","u"],["011111","v"],["100000","w"],["100001","x"],["100010","y"],["100011","z"],["100100","A"],["100101","B"],["100110","C"],["100111","D"],["101000","E"],["101001","F"],["101010","G"],["101011","H"],["101100","I"],["101101","J"],["101110","K"],["101111","L"],["110000","M"],["110001","N"],["110010","O"],["110011","P"],["110100","Q"],["110101","R"],["110110","S"],["110111","T"],["111000","U"],["111001","V"],["111010","W"],["111011","X"],["111100","Y"],["111101","Z"],["111110","*"],["111111","$"]]),f=new Map(d),m=new Map(d.map((function(e){return e.reverse()}))),p=function(){function e(e,t){switch(this.encodedString=void 0,this.decodedMapData=void 0,this.codeType=void 0,this.codeType=e,e){case"ened":t&&(this.encodedString=t);break;case"deed":t&&(this.decodedMapData=t)}}var t=e.prototype;return t.decodeParamData=function(){if("deed"===this.codeType)return null;for(var e,t=function(e){for(var t=e.length,n=0,a=[];!(t-n<=0);)a.push(m.get(e.substring(n,n+1))||""),n+=1;return a.join("")}(this.encodedString),n=t.substring(2,t.length),a=0,r=[];n.length-a>=4;)r.push({color:(e=n.substring(a,a+4),4===e.length?parseInt(e,2):-1)}),a+=4;return this.decodedMapData=r,this.decodedMapData},t.encodeParamData=function(){if("ened"===this.codeType)return null;var e="00"+this.decodedMapData.map((function(e){return function(e){var t=parseInt(e).toString(2),n=t.length;if(n<4)for(var a=0;a<4-n;a++)t="0"+t;return t}(e.color)})).join("");return this.encodedString=function(e){for(var t=e.length,n=0,a=[],r=e+new Array(6-t%6).fill(0).join("");!(t-n<=0);)a.push(f.get(r.substring(n,n+6))||""),n+=6;return a.join("")}(e),this.encodedString},e}();function h(e){return(0,r.createElement)(i.Z,{className:"Loading",style:{display:e.loading?"flex":"none"}},(0,r.createElement)(i.Z,{className:"icon-container"},(0,r.createElement)(i.Z,{className:"icon",style:{backgroundImage:"url('https://lakphy.me/pixel/assets/loading.png')"}})),(0,r.createElement)(i.Z,{className:"loading-text"},"Loading..."))}function E(e){var t=e.show,n=e.text,a=e.onConfirm,o=e.inputs;return(0,r.createElement)(i.Z,{className:"Notice",style:{display:t?"flex":"none"}},(0,r.createElement)(i.Z,{className:"notice-text"},n),(0,r.createElement)("input",{className:"notice-inputs",value:o,onClick:function(e){e.target.select(),document.execCommand("copy")}}),(0,r.createElement)(i.Z,{className:"control-btn",onClick:a},"OK"))}function g(){return g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},g.apply(this,arguments)}function x(){var e,t=(0,r.useState)(Math.min(.96*window.innerWidth,800)),n=t[0],l=t[1],u=(0,r.useState)(!0),d=u[0],f=u[1],m=(0,r.useState)({show:!1,text:"",inputs:"",handleConfirm:function(){}}),x=m[0],w=m[1],N=(0,r.useState)(c),v=N[0],y=N[1];return(0,r.useEffect)((function(){var e=function(){l(Math.min(.96*window.innerWidth,800))};window.addEventListener("resize",e);var t=(0,s.Z)();if(t.x&&t.x.length>0){var n=function(){var e=(0,s.Z)();return console.log(e),e.x&&e.x.length>0?new p("ened",e.x).decodeParamData():[]}();n.length>=16?(y((function(e){return g({},e,{matrix:parseInt(Math.sqrt(n.length).toString(),10),drawingMap:n.slice(0,Math.pow(parseInt(Math.sqrt(n.length).toString(),10),2)),editable:!1,received:!0})})),setTimeout((function(){f(!1)}),500)):setTimeout((function(){f(!1)}),500)}else setTimeout((function(){f(!1)}),500);return function(){window.removeEventListener("resize",e)}}),[]),(0,r.createElement)(r.Fragment,null,(0,r.createElement)(h,{loading:d}),(0,r.createElement)(E,{show:x.show,text:x.text,onConfirm:x.handleConfirm,inputs:x.inputs}),(0,r.createElement)(i.Z,{className:"safe-view",style:{width:n+"px"}},(0,r.createElement)(i.Z,{className:"matrix-back",style:{width:n+"px",height:n+"px"}}),(0,r.createElement)(i.Z,{className:"matrix-container",style:{width:n+"px",height:n+"px"},onClick:function(e){var t=parseInt(e.target.dataset.index,10);if((0===t||t)&&v.matrix>1){if(!v.editable)return null;y((function(e){var n=e.drawingMap;return n[t]={color:v.currentColor},g({},e,{draftMap:n})}))}else{if(!(t&&v.matrix<=1))return null;y((function(e){return g({},e,{matrix:t,drawingMap:new Array(t*t).fill(null).map((function(){return{color:a.WHITE}}))})}))}return null}},v.matrix>1?(e=v).drawingMap.map((function(t,a){return(0,r.createElement)(i.Z,{style:{backgroundColor:o[t.color],width:.67*n/e.matrix+"px",height:.67*n/e.matrix+"px",margin:.05*n/e.matrix+"px",borderRadius:.1*n/e.matrix+"px"},className:"matrix-block","data-index":a,key:a.toString()})})):(0,r.createElement)(r.Fragment,null,(0,r.createElement)(i.Z,{className:"selector-title"},"Please select the drawing size:"),new Array(n<300?7:n<340?9:n<380?11:n<500?14:n<585?21:25).fill((0,r.createElement)(r.Fragment,null)).map((function(e,t){return t>=5?(0,r.createElement)(i.Z,{key:t,className:"selector-container","data-index":t},(0,r.createElement)(i.Z,{className:"selector-back","data-index":t}),(0,r.createElement)(i.Z,{className:"selector","data-index":t},t)):null})))),(0,r.createElement)(i.Z,{className:"notice"},v.received?'You received an awesome pixel art, click "Edit" to release your inspiration, click "Share" to share your canvas with others, click "Clear" to clear the canvas.':""),(0,r.createElement)(i.Z,{className:"controls"},(0,r.createElement)(i.Z,{className:"control-btn",onClick:function(){y(c),history.pushState({},"","#/")}},"Clear"),(0,r.createElement)(i.Z,{className:"control-btn",onClick:function(){y((function(e){return g({},e,{editable:!e.editable,received:!1})}))}},v.editable?"Done":"Edit"),(0,r.createElement)(i.Z,{className:"control-btn",onClick:function(){if(!(v.matrix<=1)){var e=new p("deed",v.drawingMap).encodeParamData();console.log(e),history.pushState({},"","#/?x="+e),w((function(e){return g({},e,{show:!0,text:"Your canvas sharing link has been generated, please click the window below to copy.",inputs:location.href,handleConfirm:function(){w((function(e){return g({},e,{show:!1})}))}})}))}}},"Share")),(0,r.createElement)(i.Z,{className:"color-selector",onClick:function(e){var t=e.target.dataset.color;(0===t||t)&&y((function(e){return g({},e,{currentColor:t})}))}},o.map((function(e,t){return(0,r.createElement)(i.Z,{className:"color-unit",key:t},(0,r.createElement)(i.Z,{className:"color-back"}),(0,r.createElement)(i.Z,{className:"color-front",style:{backgroundColor:o[t]},"data-color":t},(0,r.createElement)("img",{"data-color":t,className:"color-sign",src:13===t||12===t||11===t||10===t||9===t||1===t||2===t?"https://lakphy.me/pixel/assets/pen-white.png":"https://lakphy.me/pixel/assets/pen-black.png",style:o[v.currentColor]===e?{opacity:1,transform:"scale(1)"}:{opacity:0,transform:"scale(0.01)"}})))})))))}}}]);